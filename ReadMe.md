# Задание

**Формулировка:** На входе есть большой текстовый файл, где каждая строка имеет вид Number. String
Например:
```
415. Apple
30432. Something something something
1. Apple
32. Cherry is the best
2. Banana is yellow
```
   Обе части могут в пределах файла повторяться. Необходимо получить на выходе другой файл, где
   все строки отсортированы.

   **Критерий сортировки:** сначала сравнивается часть `String`, если она
   совпадает, тогда `Number`. Т.е. в примере выше должно получиться
```
1. Apple
415. Apple
2. Banana is yellow
32. Cherry is the best
30432. Something something something
```

## Требуется написать две программы:
1. *Утилита для создания тестового файла заданного размера*. Результатом работы должен быть
   текстовый файл описанного выше вида. Должно быть какое-то количество строк с одинаковой
   частью String.
2. *Собственно сортировщик*. Важный момент, файл может быть очень большой. Для тестирования
   будет использоваться размер `~100Gb`.

## Критерии оценки
   При оценке выполненного задания мы будем в первую очередь смотреть на результат
   (корректность генерации/сортировки и время работы), во вторую на то, как кандидат пишет код.
   
## Используемые технологии
**Язык программирования**: C#.

---

# Описание решения

## Деплой

Вся логика запуска лежит в скрипте `script.sh`. Для проверки необходимо запустить скрипт. После запуска он предложит ввести имя для генерируемого файла со словами и размер файла в мегабайтах.
Пример:

```
–@MacBook-Pro Sorter % ./script.sh
Enter name for generated random words file [words.txt]:

Enter the size of file in Megabytes [1024]:

```
Дальше скрипт выполнит построение проекта, сборку артефакта в директорию `Artifacts` и запустит приложения генерации и сортировки. На экране будет оттображаться время операций. В результате в директории `Artifacts` будут лежать три директории и два файла с несортированными словами и результатом сортировки.

## Логика приложения

Решение реализуется через *map-reduce* схему.
На шаге **Map** входной файл разбивается на части размером не больше 50_000_000 символов. Каждая часть сортируется и записывается на диск с дополнительной информацией, ускоряющей сортировку.
На шаге **Reduce** все части собираются в один отсортированный файл при помощи MergeSort. Для поддержания слияния нескольких файлов и уменьшения сравнений используется структура данных – двоичная куча.

## Структура проекта

- `Algorithms` – проект с структурами данных и вариантами алгоритмов сортировки;
- `Benchmarks` – проект с бенчмарками для каждого алгоритма сортировки;
- `UnitTests` – проект с тестами для каждого алгоритма сортировки;
- `DataGenerator` – приложение для генерации файла с случайными строками;
- `Application` – приложение сортирующее файлы;
- директория `Archive` – содержит разные технические имплиментации приложения сортировки:
  - *Solution_simplest* – первая итерация решения;
  - *Solution_meta* – добавление сохранения метаинформации для сортировки;
  - *Solution_sorter* – вынесение сортировки на шаге Map в отдельную структуру;
  - *Solution_parallel* – параллелизация сортировки на шаге Map;
  - *Solution_directmetawrite* – замена аллокации памяти для мета-информации на прямую запись в файл;
  - *Solution_unifiedbuffer* – уменьшение аллокаций для сортировки: пользуемся единожды выделенной памятью;
  - *Solution_asyncio* – перевод вывода на асинхронные операции;
- директория `Source` – содержит словари со словами, из которых будет генерироваться большой файл.